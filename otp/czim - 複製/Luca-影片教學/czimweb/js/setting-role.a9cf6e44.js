(window.webpackJsonp=window.webpackJsonp||[]).push([["setting-role","setting-role-permission","setting-role-save"],{2083:function(e,t,n){"use strict";n.r(t);n("b0c0");var o=n("7a23"),r={class:"left-panel"},a={class:"right-panel"},c={class:"right-panel-search"},l=Object(o.createTextVNode)("编辑"),i=Object(o.createTextVNode)("删除");var s=n("1da1"),u=(n("96cf"),n("d81d"),n("d3b7"),n("4160"),n("159b"),n("2a626")),d=n("73f2"),b={name:"role",components:{saveDialog:u.default,permissionDialog:d.default},data:function(){return{dialog:{save:!1,permission:!1},tableData:[],searchList:{name:""},total:0,pageSize:10,currentPage:1,selection:[],height:"100%",search:{keyword:null},loading:!1,emptyText:"暂无数据"}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;return Object(s.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$API.sysRole.getSysRole.post({page:e.currentPage,size:e.pageSize,name:e.searchList.name});case 3:if(n=t.sent,console.log(n),e.loading=!1,0===n.code){t.next=8;break}return t.abrupt("return",e.$message.error("获取数据失败"));case 8:e.tableData=n.data.rows,e.pageSize=n.data.pageSize,e.total=n.data.total,e.currentPage=n.data.page;case 12:case"end":return t.stop()}}),t)})))()},add:function(){var e=this;this.dialog.save=!0,this.$nextTick((function(){e.$refs.saveDialog.open()}))},table_edit:function(e){var t=this;this.dialog.save=!0,this.$nextTick((function(){t.$refs.saveDialog.open("edit").setData(e.id)}))},permission:function(){var e=this;this.dialog.permission=!0,this.$nextTick((function(){e.$refs.permissionDialog.open()}))},table_del:function(e){var t=this;return Object(s.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$API.sysRole.deleteRole.post([e.id]);case 2:0==(o=n.sent).code?(t.getData(),t.$message.success("删除成功")):t.$alert(o.message,"提示",{type:"error"});case 4:case"end":return n.stop()}}),n)})))()},handleCurrentChange:function(e){this.currentPage=e,this.getData()},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.getData()},refresh:function(){this.getData()},batch_del:function(){var e=this;return Object(s.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$confirm("确定删除选中的 ".concat(e.selection.length," 项吗？如果删除项中含有子集将会被一并删除"),"提示",{type:"warning"}).then(Object(s.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$API.sysRole.deleteRole.post(e.selection.map((function(e){return e.id})));case 3:0!==(n=t.sent).code&&Promise.reject(n.message),e.getData(),e.$message.success("操作成功");case 7:case"end":return t.stop()}}),t)})))).catch((function(e){console.log(e)}));case 1:case"end":return t.stop()}}),t)})))()},selectionChange:function(e){console.log(e),this.selection=e},searchRole:function(){this.getData()},resetSearch:function(){for(var e in this.searchList)console.log(e),this.searchList[e]="";this.getData()},filterTree:function(e){var t=null;return function n(o){o.forEach((function(o){o.id==e&&(t=o),o.children&&n(o.children)}))}(this.$refs.table.tableData),t},handleSaveSuccess:function(e,t){"add"!=t&&"edit"!=t||this.getData()}}},f=(n("96ca"),n("6b0d"));const m=n.n(f)()(b,[["render",function(e,t,n,s,u,d){var b=Object(o.resolveComponent)("el-button"),f=Object(o.resolveComponent)("el-input"),m=Object(o.resolveComponent)("el-header"),p=Object(o.resolveComponent)("el-table-column"),h=Object(o.resolveComponent)("el-divider"),g=Object(o.resolveComponent)("el-popconfirm"),O=Object(o.resolveComponent)("kxTable"),j=Object(o.resolveComponent)("el-main"),v=Object(o.resolveComponent)("el-container"),C=Object(o.resolveComponent)("save-dialog"),k=Object(o.resolveComponent)("permission-dialog");return Object(o.openBlock)(),Object(o.createElementBlock)(o.Fragment,null,[Object(o.createVNode)(v,null,{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(m,null,{default:Object(o.withCtx)((function(){return[Object(o.createElementVNode)("div",r,[Object(o.createVNode)(b,{type:"primary",icon:"el-icon-plus",onClick:d.add},null,8,["onClick"]),Object(o.createVNode)(b,{type:"danger",plain:"",icon:"el-icon-delete",disabled:0==u.selection.length,onClick:d.batch_del},null,8,["disabled","onClick"])]),Object(o.createElementVNode)("div",a,[Object(o.createElementVNode)("div",c,[Object(o.createVNode)(f,{modelValue:u.searchList.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return u.searchList.name=e}),placeholder:"角色名称",clearable:""},null,8,["modelValue"]),Object(o.createVNode)(b,{type:"primary",icon:"el-icon-search",onClick:d.searchRole},null,8,["onClick"]),Object(o.createVNode)(b,{type:"info",plain:"",icon:"el-icon-refresh",onClick:d.resetSearch,disabled:u.searchList.name.length<1},null,8,["onClick","disabled"])])])]})),_:1}),Object(o.createVNode)(j,{class:"nopadding"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(O,{data:u.tableData,ref:"kxTable",rowKey:"id",total:u.total,loading:u.loading,stripe:!0,onHandleCurrentChange:d.handleCurrentChange,onHandleSizeChange:d.handleSizeChange,onRefresh:d.refresh,onSelectionChange:d.selectionChange},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(p,{type:"selection",width:"50"}),Object(o.createVNode)(p,{type:"index",label:"#",width:"50"}),Object(o.createVNode)(p,{prop:"name",label:"角色名称",width:"250"}),Object(o.createVNode)(p,{prop:"number",label:"排序",width:"150"}),Object(o.createVNode)(p,{prop:"remark",label:"说明"}),Object(o.createVNode)(p,{fixed:"right",label:"操作",width:"140"},{default:Object(o.withCtx)((function(e){return[Object(o.createVNode)(b,{type:"text",size:"small",onClick:function(t){return d.table_edit(e.row,e.$index)}},{default:Object(o.withCtx)((function(){return[l]})),_:2},1032,["onClick"]),Object(o.createVNode)(h,{direction:"vertical"}),Object(o.createVNode)(g,{title:"确定删除吗？",onConfirm:function(t){return d.table_del(e.row,e.$index)}},{reference:Object(o.withCtx)((function(){return[Object(o.createVNode)(b,{type:"text",size:"small",style:{color:"#f56c6c"}},{default:Object(o.withCtx)((function(){return[i]})),_:1})]})),_:2},1032,["onConfirm"])]})),_:1})]})),_:1},8,["data","total","loading","onHandleCurrentChange","onHandleSizeChange","onRefresh","onSelectionChange"])]})),_:1})]})),_:1}),u.dialog.save?(Object(o.openBlock)(),Object(o.createBlock)(C,{key:0,ref:"saveDialog",onSuccess:d.handleSaveSuccess,onClosed:t[1]||(t[1]=function(e){return u.dialog.save=!1})},null,8,["onSuccess"])):Object(o.createCommentVNode)("",!0),u.dialog.permission?(Object(o.openBlock)(),Object(o.createBlock)(k,{key:1,ref:"permissionDialog",onClosed:t[2]||(t[2]=function(e){return u.dialog.permission=!1})},null,512)):Object(o.createCommentVNode)("",!0)],64)}],["__scopeId","data-v-087087b6"]]);t.default=m},"2a626":function(e,t,n){"use strict";n.r(t);n("b0c0");var o=n("7a23"),r=Object(o.createTextVNode)("取 消"),a=Object(o.createTextVNode)("保 存");var c=n("1da1"),l=(n("96cf"),{emits:["success","closed"],data:function(){return{mode:"add",titleMap:{edit:"编辑",add:"新增"},visible:!1,isSaveing:!1,form:{name:"",number:1,remark:"",id:""},roleId:"",loading:!1,rules:{number:[{required:!0,message:"请输入排序",trigger:"change"}],name:[{required:!0,message:"请输入角色名称"}],remark:[{required:!0,message:"请输入角色说明"}]},groups:[],groupsProps:{value:"id",emitPath:!1,checkStrictly:!0}}},methods:{open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add";return this.mode=e,this.visible=!0,this},getRoleData:function(e){var t=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,n.next=3,t.$API.sysRole.getRoleById.get(e);case 3:if(o=n.sent,console.log(o),t.loading=!1,0===o.code){n.next=8;break}return n.abrupt("return",t.$message.error("获取数据失败"));case 8:t.form.name=o.data.form.name,t.form.number=o.data.form.number,t.form.remark=o.data.form.remark;case 11:case"end":return n.stop()}}),n)})))()},submit:function(){var e=this;this.$refs.dialogForm.validate(function(){var t=Object(c.a)(regeneratorRuntime.mark((function t(n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=7;break}return e.isSaveing=!0,t.next=4,e.$API.sysRole.createOrEditRole.post(e.form);case 4:o=t.sent,e.isSaveing=!1,0==o.code?(e.$emit("success",e.form,e.mode),e.visible=!1,e.$message.success("操作成功")):e.$alert(o.message,"提示",{type:"error"});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},setData:function(e){console.log(e),this.form.id=e,this.getRoleData(e)}}}),i=n("6b0d");const s=n.n(i)()(l,[["render",function(e,t,n,c,l,i){var s=Object(o.resolveComponent)("el-input"),u=Object(o.resolveComponent)("el-form-item"),d=Object(o.resolveComponent)("el-input-number"),b=Object(o.resolveComponent)("el-form"),f=Object(o.resolveComponent)("el-button"),m=Object(o.resolveComponent)("el-dialog"),p=Object(o.resolveDirective)("loading");return Object(o.openBlock)(),Object(o.createBlock)(m,{title:l.titleMap[l.mode],modelValue:l.visible,"onUpdate:modelValue":t[5]||(t[5]=function(e){return l.visible=e}),width:500,"destroy-on-close":"",onClosed:t[6]||(t[6]=function(t){return e.$emit("closed")})},{footer:Object(o.withCtx)((function(){return[Object(o.createVNode)(f,{onClick:t[3]||(t[3]=function(e){return l.visible=!1})},{default:Object(o.withCtx)((function(){return[r]})),_:1}),Object(o.createVNode)(f,{type:"primary",loading:l.isSaveing,onClick:t[4]||(t[4]=function(e){return i.submit()})},{default:Object(o.withCtx)((function(){return[a]})),_:1},8,["loading"])]})),default:Object(o.withCtx)((function(){return[Object(o.withDirectives)(Object(o.createVNode)(b,{model:l.form,rules:l.rules,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(u,{label:"角色名称",prop:"name"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(s,{modelValue:l.form.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return l.form.name=e}),clearable:""},null,8,["modelValue"])]})),_:1}),Object(o.createVNode)(u,{label:"排序",prop:"number"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(d,{modelValue:l.form.number,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.form.number=e}),"controls-position":"right",min:1,style:{width:"100%"}},null,8,["modelValue"])]})),_:1}),Object(o.createVNode)(u,{label:"说明",prop:"remark"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(s,{modelValue:l.form.remark,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.form.remark=e}),clearable:""},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model","rules"]),[[p,l.loading]])]})),_:1},8,["title","modelValue"])}]]);t.default=s},6383:function(e,t,n){"use strict";n("666e")},"666e":function(e,t,n){},"73f2":function(e,t,n){"use strict";n.r(t);var o=n("7a23"),r={class:"treeMain"},a={class:"treeMain"},c={class:"treeMain"},l={style:{float:"left"}},i={style:{float:"right",color:"#8492a6","font-size":"12px"}},s=function(e){return Object(o.pushScopeId)("data-v-fcd309be"),e=e(),Object(o.popScopeId)(),e}((function(){return Object(o.createElementVNode)("div",{class:"el-form-item-msg"},"用于控制角色登录后控制台的视图",-1)})),u=Object(o.createTextVNode)("取 消"),d=Object(o.createTextVNode)("保 存");var b=n("1da1"),f=(n("96cf"),{emits:["success","closed"],data:function(){return{visible:!1,isSaveing:!1,menu:{list:[],checked:["test","system","user","role"],props:{label:function(e){return e.meta.title}}},group:{list:[],checked:[],props:{}},type:{list:[],checked:[],props:{}},dashboard:"0",dashboardOptions:[{value:"0",label:"数据统计",views:"stats"},{value:"1",label:"工作台",views:"work"}]}},mounted:function(){this.getMenu(),this.getGroup(),this.getType()},methods:{open:function(){this.visible=!0},submit:function(){var e=this;this.isSaveing=!0,setTimeout((function(){e.isSaveing=!1,e.visible=!1,e.$message.success("操作成功"),e.$emit("success")}),1e3)},getMenu:function(){var e=this;return Object(b.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$API.system.menu.list.get();case 2:n=t.sent,e.menu.list=n.data;case 4:case"end":return t.stop()}}),t)})))()},getGroup:function(){this.group.list=[{label:"JL00"},{label:"LP01"},{label:"LP07"},{label:"SL01"},{label:"TL06"},{label:"TL09"},{label:"YP07"}]},getType:function(){this.type.list=[{label:"原料采购"},{label:"厂内互供"},{label:"炼销订单"},{label:"化工统销订单"},{label:"移库单"},{label:"自销订单"}]}}}),m=(n("6383"),n("6b0d"));const p=n.n(m)()(f,[["render",function(e,t,n,b,f,m){var p=Object(o.resolveComponent)("el-tree"),h=Object(o.resolveComponent)("el-tab-pane"),g=Object(o.resolveComponent)("el-option"),O=Object(o.resolveComponent)("el-select"),j=Object(o.resolveComponent)("el-form-item"),v=Object(o.resolveComponent)("el-form"),C=Object(o.resolveComponent)("el-tabs"),k=Object(o.resolveComponent)("el-button"),V=Object(o.resolveComponent)("el-dialog");return Object(o.openBlock)(),Object(o.createBlock)(V,{title:"角色权限设置",modelValue:f.visible,"onUpdate:modelValue":t[3]||(t[3]=function(e){return f.visible=e}),width:500,"destroy-on-close":"",onClosed:t[4]||(t[4]=function(t){return e.$emit("closed")})},{footer:Object(o.withCtx)((function(){return[Object(o.createVNode)(k,{onClick:t[1]||(t[1]=function(e){return f.visible=!1})},{default:Object(o.withCtx)((function(){return[u]})),_:1}),Object(o.createVNode)(k,{type:"primary",loading:f.isSaveing,onClick:t[2]||(t[2]=function(e){return m.submit()})},{default:Object(o.withCtx)((function(){return[d]})),_:1},8,["loading"])]})),default:Object(o.withCtx)((function(){return[Object(o.createVNode)(C,{"tab-position":"top"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(h,{label:"菜单权限"},{default:Object(o.withCtx)((function(){return[Object(o.createElementVNode)("div",r,[Object(o.createVNode)(p,{ref:"menu","node-key":"name",data:f.menu.list,"default-checked-keys":f.menu.checked,props:f.menu.props,"show-checkbox":""},null,8,["data","default-checked-keys","props"])])]})),_:1}),Object(o.createVNode)(h,{label:"部门权限"},{default:Object(o.withCtx)((function(){return[Object(o.createElementVNode)("div",a,[Object(o.createVNode)(p,{ref:"group","node-key":"name",data:f.group.list,"default-checked-keys":f.group.checked,props:f.group.props,"show-checkbox":""},null,8,["data","default-checked-keys","props"])])]})),_:1}),Object(o.createVNode)(h,{label:"类型权限"},{default:Object(o.withCtx)((function(){return[Object(o.createElementVNode)("div",c,[Object(o.createVNode)(p,{ref:"type","node-key":"name",data:f.type.list,"default-checked-keys":f.type.checked,props:f.type.props,"show-checkbox":""},null,8,["data","default-checked-keys","props"])])]})),_:1}),Object(o.createVNode)(h,{label:"控制台"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(v,{"label-width":"100px","label-position":"left"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(j,{label:"控制台视图"},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(O,{modelValue:f.dashboard,"onUpdate:modelValue":t[0]||(t[0]=function(e){return f.dashboard=e}),placeholder:"请选择"},{default:Object(o.withCtx)((function(){return[(Object(o.openBlock)(!0),Object(o.createElementBlock)(o.Fragment,null,Object(o.renderList)(f.dashboardOptions,(function(e){return Object(o.openBlock)(),Object(o.createBlock)(g,{key:e.value,label:e.label,value:e.value},{default:Object(o.withCtx)((function(){return[Object(o.createElementVNode)("span",l,Object(o.toDisplayString)(e.label),1),Object(o.createElementVNode)("span",i,Object(o.toDisplayString)(e.views),1)]})),_:2},1032,["label","value"])})),128))]})),_:1},8,["modelValue"]),s]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["modelValue"])}],["__scopeId","data-v-fcd309be"]]);t.default=p},"96ca":function(e,t,n){"use strict";n("e4db")},e4db:function(e,t,n){}}]);